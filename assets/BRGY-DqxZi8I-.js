import{a0 as f,a1 as n,V as e}from"./libs-CZASmHnA.js";const v=({accountAddress:l,contrato:s,isViewerMode:N})=>{const[i,h]=n.useState({imagerobots:[],loading:!0,error:null}),o=n.useRef(!0),x=n.useRef(null),b=n.useRef(0),j=n.useRef(null),t=n.useCallback(async()=>{if(!s?.ready||!s?.MBOX||!s?.BRGY){console.log("Contracts not ready yet");return}if(!l){console.log("No account address available");return}try{h(r=>({...r,loading:!0,error:null}));let c=[];for(let r=0;r<25;r++)try{const a=await s.MBOX.entregaNFT(l,r).call();if(a)c.push(parseInt(a));else break}catch(a){console.log("No more NFTs for this user",a);break}if(c.length===0){o.current&&h({imagerobots:[],loading:!1,error:null});return}const m=await Promise.all(c.map(async r=>{try{const a=await s.BRGY.ownerOf(r).call();return window.tronWeb.address.fromHex(a)===l}catch(a){return console.error(`Error checking ownership for NFT ${r}:`,a),!1}})),g=c.map(async(r,a)=>{try{const d=await s.BRGY.tokenURI(r).call();return{...await(await fetch(d)).json(),numero:r,isOwned:m[a]}}catch(d){return console.error(`Error fetching metadata for NFT ${r}:`,d),{numero:r,name:`NFT #${r}`,image:"",isOwned:m[a],error:!0}}}),p=(await Promise.all(g)).map((r,a)=>{const d=r.isOwned?null:e.jsx("button",{className:"btn btn-success",onClick:async()=>{try{await s.MBOX.claimNFT_especifico(a).send(),setTimeout(()=>t(),3e3)}catch(u){console.error("Error claiming NFT:",u)}},children:"Claim"});return e.jsx("div",{className:"col-xl-3 col-lg-6 col-sm-6",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"new-arrival-product",children:[e.jsx("div",{className:"new-arrivals-img-contnent",children:r.image?e.jsx("a",{href:r.image,rel:"noopener noreferrer",target:"_blank",children:e.jsx("img",{src:r.image,alt:r.name,className:"img-thumbnail",onError:u=>{u.target.src="/images/brgy.png"}})}):e.jsx("img",{src:"/images/brgy.png",alt:r.name,className:"img-thumbnail"})}),e.jsxs("div",{className:"new-arrival-content text-center mt-3",children:[e.jsxs("h4",{children:["#",r.numero," ",r.name]}),d]})]})})})},`robbrutN${r.numero}`)});o.current&&h({imagerobots:p,loading:!1,error:null})}catch(c){console.error("Error fetching NFT data:",c),o.current&&h(m=>({...m,loading:!1,error:c.message||"Failed to load NFT data"}))}},[l,s]);return n.useEffect(()=>{j.current!==l&&(console.log(`Wallet address changed from ${j.current} to ${l}`),j.current=l,s?.ready&&t())},[l,s?.ready,t]),n.useEffect(()=>(o.current=!0,document.title="BRGY | Brutus.Finance",s?.ready&&l&&t(),x.current=setInterval(()=>{if(!o.current)return;const c=Date.now(),m=s?.ready?120*1e3:3*1e3;c>=b.current&&(b.current=c+m,s?.ready&&l&&t())},3e3),()=>{o.current=!1,x.current&&(clearInterval(x.current),x.current=null)}),[s?.ready,l,t]),i.loading&&i.imagerobots.length===0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row page-titles mx-0",children:[e.jsx("div",{className:"col-sm-6 p-md-0",children:e.jsxs("div",{className:"welcome-text",children:[e.jsx("h4",{children:"My Collectibles"}),e.jsx("p",{className:"mb-0",children:"BRGY"})]})}),e.jsx("div",{className:"col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex",children:e.jsxs("ol",{className:"breadcrumb",children:[e.jsx("li",{className:"breadcrumb-item",children:"All collection on "}),e.jsx("li",{className:"breadcrumb-item active",children:e.jsx("a",{href:"https://marketplace.ainft.com/#/collection/TGpQ3qap18rN1vMJj3pveMfqTeXDaKaDE7",rel:"noopener noreferrer",target:"_blank",children:"APENFT"})})]})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-5",children:[e.jsx("img",{src:"/images/cargando.gif",height:"40px",alt:"Loading..."}),e.jsx("p",{className:"mt-3",children:"Loading your NFT collection..."}),N&&e.jsx("p",{className:"text-muted",style:{fontSize:"0.9em"},children:"Connect your wallet to view your personal collection"})]})})})})]}):i.error?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row page-titles mx-0",children:[e.jsx("div",{className:"col-sm-6 p-md-0",children:e.jsxs("div",{className:"welcome-text",children:[e.jsx("h4",{children:"My Collectibles"}),e.jsx("p",{className:"mb-0",children:"BRGY"})]})}),e.jsx("div",{className:"col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex",children:e.jsxs("ol",{className:"breadcrumb",children:[e.jsx("li",{className:"breadcrumb-item",children:"All collection on "}),e.jsx("li",{className:"breadcrumb-item active",children:e.jsx("a",{href:"https://marketplace.ainft.com/#/collection/TGpQ3qap18rN1vMJj3pveMfqTeXDaKaDE7",rel:"noopener noreferrer",target:"_blank",children:"APENFT"})})]})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body text-center py-5",children:e.jsxs("div",{className:"alert alert-danger",children:[e.jsx("h5",{children:"Error Loading NFTs"}),e.jsx("p",{children:i.error}),e.jsx("button",{className:"btn btn-primary mt-3",onClick:()=>t(),children:"Try Again"})]})})})})})]}):i.imagerobots.length===0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row page-titles mx-0",children:[e.jsx("div",{className:"col-sm-6 p-md-0",children:e.jsxs("div",{className:"welcome-text",children:[e.jsx("h4",{children:"My Collectibles"}),e.jsx("p",{className:"mb-0",children:"BRGY"})]})}),e.jsx("div",{className:"col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex",children:e.jsxs("ol",{className:"breadcrumb",children:[e.jsx("li",{className:"breadcrumb-item",children:"All collection on "}),e.jsx("li",{className:"breadcrumb-item active",children:e.jsx("a",{href:"https://bit.ly/Brutus-Gallery",rel:"noopener noreferrer",target:"_blank",children:"APENFT"})})]})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-5",children:[e.jsx("img",{src:"/images/brgy.png",alt:"BRGY",style:{maxWidth:"200px",opacity:.5}}),e.jsx("h4",{className:"mt-4",children:"No NFTs Found"}),e.jsx("p",{className:"text-muted",children:N?"Connect your wallet to view your NFT collection":"You don't have any BRGY NFTs yet"}),e.jsx("a",{href:"https://bit.ly/Brutus-Gallery",rel:"noopener noreferrer",target:"_blank",className:"btn btn-primary mt-3",children:"View Collection on APENFT"})]})})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row page-titles mx-0",children:[e.jsx("div",{className:"col-sm-6 p-md-0",children:e.jsxs("div",{className:"welcome-text",children:[e.jsx("h4",{children:"My Collectibles"}),e.jsx("p",{className:"mb-0",children:"BRGY"})]})}),e.jsx("div",{className:"col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex",children:e.jsxs("ol",{className:"breadcrumb",children:[e.jsx("li",{className:"breadcrumb-item",children:"All collection on "}),e.jsx("li",{className:"breadcrumb-item active",children:e.jsx("a",{href:"https://bit.ly/Brutus-Gallery",rel:"noopener noreferrer",target:"_blank",children:"APENFT"})})]})})]}),e.jsx("div",{className:"row",children:i.imagerobots})]})},F=f()(v);export{F as default};
